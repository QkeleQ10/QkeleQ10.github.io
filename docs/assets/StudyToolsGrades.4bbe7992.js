import{o as d,c as f,f as p,t as m,l as te,m as F,q as ae,u as ie,r as b,n as T,a as ne,b as N,d as o,w as s,_ as x,e as R,T as le,g as re,p as U,i as e,F as $,s as D,v as H,x as se,y as J,j as u,z as L,A as Z,h as K,B as oe,C as ue,D as ce}from"./index.e37ac361.js";const de=["data-insignificant","data-stretch"],me={key:0},v={__name:"Metric",props:{description:String,extra:String,insignificant:Boolean,stretch:Boolean},setup(j){return(V,O)=>(d(),f("div",{class:"metric","data-insignificant":j.insignificant,"data-stretch":j.stretch},[p("span",null,m(j.description),1),p("span",null,[te(V.$slots,"default"),j.extra?(d(),f("span",me," ("+m(j.extra)+")",1)):F("",!0)])],8,de))}};const ge=p("div",null,[p("h1",{class:"section-title"},"Cijferback-up"),p("p",{class:"section-about"},"Importeer je eerder geback-upte cijferoverzicht met onderstaande knop.")],-1),fe={id:"table-wrapper"},he=["data-excluded"],pe=["tabindex","aria-label","title","data-current","data-included","onClick","onKeyup"],ve={key:1},_e={id:"bar-chart"},ke=["data-grade","data-frequency","data-percentage"],ye={id:"calculator",key:"calculator"},be=["onClick","onKeyup"],we={key:0},xe=["data-x","data-y"],Se={__name:"StudyToolsGrades",setup(j){ae({title:"Cijferback-up"}),ie().setScheme("st"),Array.from({length:91},(n,i)=>i/10+1);const O=b(),q=b(),P=b();let g=b({aside:{state:!0,title:"Zijbalk",icon:"view_sidebar"},meta:{state:!0,title:"Details",icon:"info",requiresOne:!0},stats:{state:!0,title:"Statistieken",icon:"insights",requiresOne:!0,disallow:"calculator"},calculator:{state:!1,title:"Cijfercalculator",icon:"calculate",requiresOne:!0,disallow:"stats"}}),w=b([]),M=b(""),_=T(()=>{let n=[];return w.value.forEach((i,l)=>{var t;if(!y.value.has(l))for(let r of i){let a=Number((t=r.result)==null?void 0:t.replace(",",".")),c=r.className;(!(c!=null&&c.includes("gemiddeldecolumn"))||(c==null?void 0:c.includes("herkansingKolom"))||(c==null?void 0:c.includes("heeftonderliggendekolommen")))&&typeof a=="number"&&!isNaN(a)&&n.push(a)}}),n}),z=T(()=>_.value.filter(n=>n>=5.5)),B=T(()=>_.value.filter(n=>n<5.5)),S=T(()=>{const n=_.value.map(l=>Math.round(l)),i={};for(let l=1;l<=10;l++)i[l]=0;return n.forEach(l=>{l>=1&&l<=10&&i[l]++}),i}),y=b(new Set),k=b({result:"",weight:"",column:"",title:""}),h=b([]),C=b(1),Q=T(()=>{let n=[];for(let i=0,l=1;l<10;i++,l=l+.1)n[i]={x:l,y:I(h.value.map(t=>t.result).concat([l]),h.value.map(t=>t.weight).concat([C.value]))};return console.log(n),n});function A(n,i,l,t){if((n==null?void 0:n.length)>0&&(k.value={result:n,weight:i,column:l,title:t}),g.value.calculator.state&&(n==null?void 0:n.length)>0&&Number(n.replace(",","."))){let r=h.value.findIndex(a=>a.result===Number(n.replace(",","."))&&a.weight===Number(i)&&a.column===l&&a.title===t);r>=0?h.value.splice(r,1):h.value.push({result:Number(n.replace(",",".")),weight:Number(i),column:l,title:t})}}function X(n){let i=g.value[n];g.value[n].state=!i.state,i.state&&i.disallow&&(g.value[i.disallow].state=!1),Object.values(g.value).filter(l=>l.requiresOne===!0).every(l=>!l.state)&&(Object.values(g.value).filter(l=>l.requiresOne===!0)[0].state=!0)}function G(n){y.value.has(n)?y.value.delete(n):y.value.add(n)}function Y(){w.value.forEach((n,i)=>{y.value.has(i)?y.value.delete(i):y.value.add(i)})}function ee(n){w.value=[],M.value="",y.value.clear(),k.value={result:"",weight:"",column:"",title:""},h.value=[];let i=new FileReader;i.onload=async l=>{let t=JSON.parse(l.target.result);w.value.push(...t.list.reduce((r,a)=>(a.type==="rowheader"&&r.push([]),r[r.length-1].push(a),r),[[]])),M.value=new Date(t.date).toLocaleString("nl-NL",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})},i.readAsText(n.target.files[0])}function I(n=[],i=[]){let l=n.map((r,a)=>{var W;let c=(W=i[a])!=null?W:1;return[r*c,c]}).reduce((r,a)=>[r[0]+a[0],r[1]+a[1]],[0,0]),t=l[0]/l[1];return isNaN(t)?void 0:t}function E(n=[]){let i=[...n].sort();var l=Math.floor(i.length/2);if(i.length%2)return i[l];let t=(i[l-1]+i[l])/2;return isNaN(t)?void 0:t}return(n,i)=>{const l=ne("Button");return d(),f($,null,[(d(),N(le,{to:"#hero"},[ge,o(x,{id:"hero-buttons"},{default:s(()=>[o(l,{icon:"upload_file",class:"hero",onClick:i[0]||(i[0]=t=>q.value.click())},{default:s(()=>[u(m(n.$i18n("Import grades")),1)]),_:1}),p("input",{type:"file",accept:".json",onChange:ee,onInput:i[1]||(i[1]=t=>O.value.scrollIntoView({behavior:"smooth"})),ref_key:"input",ref:q,id:"input",style:{display:"none"}},null,544)]),_:1}),o(R,null,{default:s(()=>[u("school")]),_:1})])),p("section",{ref_key:"grades",ref:O,id:"grades",class:"full max-full"},[o(re,{icon:"summarize"},{default:s(()=>[u("Cijferoverzicht")]),_:1}),o(x,{id:"grade-actions",wrap:""},{default:s(()=>[o(x,{gapless:""},{default:s(()=>[(d(!0),f($,null,D(e(g),(t,r)=>(d(),N(l,{icon:e(g)[r].icon,class:"narrow toggle","data-state":e(g)[r].state,title:e(g)[r].title+(e(g)[r].state?" verbergen":" weergeven"),onClick:a=>X(r)},null,8,["icon","data-state","title","onClick"]))),256))]),_:1}),o(l,{icon:"deselect",class:"secondary",title:"Selectie omkeren",onClick:i[2]||(i[2]=t=>Y())}),o(l,{icon:"upload_file",class:"secondary",title:n.$i18n("Import grades"),onClick:i[3]||(i[3]=t=>q.value.click())},{default:s(()=>[u(m(n.$i18n("Import grades")),1)]),_:1},8,["title"])]),_:1}),p("div",{ref_key:"container",ref:P,id:"container",class:U(e(g).aside.state?"":"hide-aside")},[p("div",fe,[p("table",null,[(d(!0),f($,null,D(e(w),(t,r)=>(d(),f("tr",{"data-excluded":e(y).has(r),key:r},[(d(!0),f($,null,D(t,a=>(d(),f("td",{class:U(a.className),key:a.column},[p("span",{tabindex:a.result?1:-1,role:"button","aria-label":a.result?`${(a.className.includes("gemiddeldecolumn")?"Gemiddeld ":"")+a.result} voor ${t[0].title}. Titel: ${a.title}. Kolom: ${a.column}. Telt ${a.weight} keer mee.`:"Lege cel",title:`${a.result||"Lege cel"}
${a.title||"Geen kolomkop"}`,"data-current":e(k).result===a.result&&e(k).weight===a.weight&&e(k).column===a.column&&e(k).title===a.title,"data-included":e(g).calculator.state&&e(h).some(c=>c.result===Number(String(a.result).replace(",","."))&&c.weight===Number(a.weight)&&c.column===a.column&&c.title===a.title),onClick:c=>A(a.result,a.weight,a.column,a.title),onKeyup:[L(c=>A(a.result,a.weight,a.column,a.title),["enter"]),L(c=>A(a.result,a.weight,a.column,a.title),["space"])]},m(a.type==="rowheader"?a.title:a.result),41,pe),a.type==="rowheader"?(d(),N(R,{key:0,"aria-hidden":"false",role:"button",tabindex:"1",title:e(y).has(r)?"Weer aan selectie toevoegen":"Uit selectie verwijderen",onClick:c=>G(r),onKeyup:[L(c=>G(r),["enter"]),L(c=>G(r),["space"])]},{default:s(()=>[u(m(e(y).has(r)?"check_box_outline_blank":"check_box"),1)]),_:2},1032,["title","onClick","onKeyup"])):F("",!0)],2))),128))],8,he))),128))]),H(p("p",null,'Je cijferoverzicht zal hier verschijnen wanneer je deze hebt ge\xFCpload met de knop "'+m(n.$i18n("Import grades"))+'".',513),[[se,e(w).length===0]])]),o(J,{name:"aside",tag:"div",id:"aside"},{default:s(()=>[e(g).meta.state?(d(),N(K,{id:"meta",key:"meta",small:""},Z({title:s(()=>[u("Details")]),content:s(()=>[e(w).length>0?(d(),N(x,{key:0,stretch:"",uniform:"",wrap:""},{default:s(()=>[o(v,{description:"Resultaat",stretch:""},{default:s(()=>[u(m(e(k).result||"?"),1)]),_:1}),o(v,{description:"Weegfactor",insignificant:""},{default:s(()=>[u(m(e(k).weight>0?e(k).weight+"\xD7":e(k).weight===0?"formatief":"?"),1)]),_:1}),o(v,{description:"Kolomnaam",insignificant:""},{default:s(()=>[u(m(e(k).column||"?"),1)]),_:1}),o(v,{description:"Kolomkop",insignificant:"",stretch:""},{default:s(()=>[u(m(e(k).title||"Klik op een cijfer"),1)]),_:1})]),_:1})):(d(),f("p",ve,"Upload je cijfers om details te bekijken."))]),_:2},[e(M)&&e(w).length>0?{name:"subtitle",fn:s(()=>[u("Gegevens ge\xEFmporteerd uit back-up van "+m(e(M)),1)]),key:"0"}:void 0]),1024)):F("",!0),e(g).stats.state?(d(),N(K,{id:"grade-stats",key:"grade-stats",small:""},Z({title:s(()=>[u("Statistieken")]),_:2},[e(_).length>0?{name:"content",fn:s(()=>[o(x,{stretch:"",uniform:"",wrap:""},{default:s(()=>[o(v,{description:"Gemiddelde (excl. weging)"},{default:s(()=>{var t;return[u(m(((t=I(e(_)))==null?void 0:t.toLocaleString("nl-NL",{minimumFractionDigits:3,maximumFractionDigits:3}))||"?"),1)]}),_:1}),o(v,{description:"Mediaan",insignificant:""},{default:s(()=>{var t;return[u(m(((t=E(e(_)))==null?void 0:t.toLocaleString("nl-NL",{minimumFractionDigits:1,maximumFractionDigits:1}))||"?"),1)]}),_:1}),o(v,{description:"Aantal",insignificant:""},{default:s(()=>[u(m(e(_).length),1)]),_:1}),o(v,{description:"Voldoendes",insignificant:"",extra:e(z).length?(e(z).length/e(_).length*100).toLocaleString("nl-NL",{minimumFractionDigits:1,maximumFractionDigits:1})+"%":""},{default:s(()=>[u(m(e(z).length||"geen"),1)]),_:1},8,["extra"]),o(v,{description:"Onvoldoendes",insignificant:"",extra:e(B).length?(e(B).length/e(_).length*100).toLocaleString("nl-NL",{minimumFractionDigits:1,maximumFractionDigits:1})+"%":""},{default:s(()=>[u(m(e(B).length||"geen"),1)]),_:1},8,["extra"]),o(v,{description:"Laagste cijfer",insignificant:""},{default:s(()=>[u(m(Math.min(...e(_)).toLocaleString("nl-NL",{minimumFractionDigits:1,maximumFractionDigits:1})),1)]),_:1}),o(v,{description:"Hoogste cijfer",insignificant:""},{default:s(()=>[u(m(Math.max(...e(_)).toLocaleString("nl-NL",{minimumFractionDigits:1,maximumFractionDigits:1})),1)]),_:1})]),_:1}),o(v,{id:"bar-chart-title",description:"Histogram (afgeronde behaalde cijfers)"}),p("div",_e,[(d(),f($,null,D(10,t=>p("div",{"data-grade":t,"data-frequency":e(S)[t],"data-percentage":Math.round(e(S)[t]/e(_).length*100),style:oe(`min-height: ${e(S)[t]/Math.max(...Object.values(e(S)))*100||0}%; max-height: ${e(S)[t]/Math.max(...Object.values(e(S)))*100||0}%`)},null,12,ke)),64))])]),key:"0"}:{name:"content",fn:s(()=>[u(" Er zijn geen cijfers geselecteerd. ")]),key:"1"}]),1024)):F("",!0),e(g).calculator.state?(d(),f("div",ye,[o(K,{id:"calculator-added",small:""},{title:s(()=>[u("Toegevoegde cijfers")]),content:s(()=>[o(J,{name:"list",tag:"ul"},{default:s(()=>[(d(!0),f($,null,D(e(h),(t,r)=>(d(),f("li",{key:t.column,tabindex:"1",role:"button",onClick:a=>e(h).splice(r,1),onKeyup:[L(a=>e(h).splice(r,1),["enter"]),L(a=>e(h).splice(r,1),["space"])]},m(`${t.result.toLocaleString("nl-NL",{minimumFractionDigits:1,maximumFractionDigits:1})} (${t.weight}\xD7) \u2014 ${t.column}, ${t.title}`),41,be))),128)),e(h).length<1?(d(),f("li",we,"Klik op de cijfers die je wilt toevoegen aan de berekening.")):F("",!0)]),_:1})]),_:1}),o(K,{id:"calculator-result",small:""},{content:s(()=>[o(x,{stretch:"",uniform:"",wrap:""},{default:s(()=>[o(v,{description:"Gemiddelde (incl. weging)"},{default:s(()=>{var t;return[u(m(((t=I(e(h).map(r=>r.result),e(h).map(r=>r.weight)))==null?void 0:t.toLocaleString("nl-NL",{minimumFractionDigits:2,maximumFractionDigits:2}))||"?"),1)]}),_:1}),o(v,{description:"Mediaan"},{default:s(()=>{var t;return[u(m(((t=E(e(h).map(r=>r.result)))==null?void 0:t.toLocaleString("nl-NL",{minimumFractionDigits:1,maximumFractionDigits:1}))||"?"),1)]}),_:1})]),_:1})]),_:1}),o(K,{id:"calculator-chart",small:""},{title:s(()=>[u("Toekomstig cijfer")]),subtitle:s(()=>[u("Zie hier wat je moet halen en wat je komt te staan.")]),content:s(()=>[H(p("input",{type:"number","onUpdate:modelValue":i[4]||(i[4]=t=>ce(C)?C.value=t:C=t)},null,512),[[ue,e(C)]]),o(x,{stretch:"",gapless:""},{default:s(()=>[(d(!0),f($,null,D(e(Q),t=>(d(),f("div",{class:"grid-column","data-x":t.x.toLocaleString("nl-NL",{minimumFractionDigits:1,maximumFractionDigits:1}),"data-y":t.y.toLocaleString("nl-NL",{minimumFractionDigits:2,maximumFractionDigits:2})},null,8,xe))),256))]),_:1})]),_:1})])):F("",!0)]),_:1})],2)],512)],64)}}};export{Se as default};
